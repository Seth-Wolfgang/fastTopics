<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Structure Plot — structure_plot • fastTopics</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Structure Plot — structure_plot"><meta property="og:description" content="Create a &amp;#8220;Structure plot&amp;#8221; from a multinomial topic
  model fit. The Structure plot represents the estimated topic
  proportions of each sample in a stacked bar chart, with bars of
  different colors representing different topics. Consequently,
  samples that have similar topic proportions have similar amounts
  of each color."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fastTopics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6-147</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/stephenslab/fastTopics" class="external-link">Source</a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Structure Plot</h1>
    <small class="dont-index">Source: <a href="https://github.com/stephenslab/fastTopics/blob/HEAD/R/structure_plot.R" class="external-link"><code>R/structure_plot.R</code></a></small>
    <div class="hidden name"><code>structure_plot.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create a “Structure plot” from a multinomial topic
  model fit. The Structure plot represents the estimated topic
  proportions of each sample in a stacked bar chart, with bars of
  different colors representing different topics. Consequently,
  samples that have similar topic proportions have similar amounts
  of each color.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">structure_plot</span><span class="op">(</span>
  <span class="va">fit</span>,
  <span class="va">topics</span>,
  <span class="va">grouping</span>,
  loadings_order <span class="op">=</span> <span class="st">"embed"</span>,
  n <span class="op">=</span> <span class="fl">2000</span>,
  colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#e41a1c"</span>, <span class="st">"#377eb8"</span>, <span class="st">"#4daf4a"</span>, <span class="st">"#984ea3"</span>, <span class="st">"#ff7f00"</span>, <span class="st">"#ffff33"</span>, <span class="st">"#a65628"</span>,
    <span class="st">"#f781bf"</span>, <span class="st">"#999999"</span><span class="op">)</span>,
  gap <span class="op">=</span> <span class="fl">1</span>,
  embed_method <span class="op">=</span> <span class="va">structure_plot_default_embed_method</span>,
  ggplot_call <span class="op">=</span> <span class="va">structure_plot_ggplot_call</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="fu">structure_plot_default_embed_method</span><span class="op">(</span><span class="va">fit</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for poisson_nmf_fit</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S3 method for multinom_topic_model_fit</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">structure_plot_ggplot_call</span><span class="op">(</span><span class="va">dat</span>, <span class="va">colors</span>, ticks <span class="op">=</span> <span class="cn">NULL</span>, font.size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>fit</dt>
<dd><p>An object of class “poisson_nmf_fit” or
“multinom_topic_model_fit”. If a Poisson NMF fit is provided
as input, the corresponding multinomial topic model fit is
automatically recovered using <code><a href="poisson2multinom.html">poisson2multinom</a></code>.</p></dd>
<dt>topics</dt>
<dd><p>Top-to-bottom ordering of the topics in the Structure
plot; <code>topics[1]</code> is shown on the top, <code>topics[2]</code> is
shown next, and so on. If the ordering of the topics is not
specified, the topics are automatically ordered so that the topics
with the greatest total “mass” are at shown at the bottom of
the plot. The topics may be specified by number or by name.</p></dd>
<dt>grouping</dt>
<dd><p>Optional categorical variable (a factor) with one
entry for each row of the loadings matrix <code>fit$L</code> defining a
grouping of the samples (rows). The samples (rows) are arranged
along the horizontal axis according to this grouping, then within
each group according to <code>loadings_order</code>. If
<code>grouping</code> is not a factor, an attempt is made to convert it
to a factor using <code>as.factor</code>. Note that if
<code>loadings_order</code> is specified manually, <code>grouping</code> should
be the groups for the rows of <code>fit$L</code> <em>before</em> reordering.</p></dd>
<dt>loadings_order</dt>
<dd><p>Ordering of the rows of the loadings matrix
<code>fit$L</code> along the horizontal axis the Structure plot (after
they have been grouped). If <code>loadings_order = "embed"</code>, the
ordering is generated automatically from a 1-d embedding,
separately for each group. The rows may be specified by number or
by name. Note that <code>loadings_order</code> may include all the rows
of <code>fit$L</code>, or a subset.</p></dd>
<dt>n</dt>
<dd><p>The maximum number of samples (rows of the loadings matrix
<code>fit$L</code>) to include in the plot. Typically there is little to
no benefit in including large number of samples in the Structure
plot due to screen resolution limits. Ignored if
<code>loadings_order</code> is provided.</p></dd>
<dt>colors</dt>
<dd><p>Colors used to draw topics in Structure plot. The
default colour setting is the from <a href="https://colorbrewer2.org" class="external-link">https://colorbrewer2.org</a>
(qualitative data, “9-class Set1”).</p></dd>
<dt>gap</dt>
<dd><p>The horizontal spacing between groups. Ignored if
<code>grouping</code> is not provided.</p></dd>
<dt>embed_method</dt>
<dd><p>The function used to compute an 1-d embedding
from a loadings matrix <code>fit$L</code>; only used if
<code>loadings_order = "embed"</code>. The function must accept the
multinomial topic model fit as its first input (“fit”) and
additional arguments may be passed (...). The output should be a
named numeric vector with one entry per row of <code>fit$L</code>, and
the names of the entries should be the same as the row names of
<code>fit$L</code>.</p></dd>
<dt>ggplot_call</dt>
<dd><p>The function used to create the plot. Replace
<code>structure_plot_ggplot_call</code> with your own function to
customize the appearance of the plot.</p></dd>
<dt>...</dt>
<dd><p>Additional arguments passed to <code>structure_plot</code>
(for the <code>plot</code> method) or <code>embed_method</code> (for
function <code>structure_plot</code>).</p></dd>
<dt>x</dt>
<dd><p>An object of class “poisson_nmf_fit” or
“multinom_topic_model_fit”. If a Poisson NMF fit is provided
as input, the corresponding multinomial topic model fit is
automatically recovered using <code><a href="poisson2multinom.html">poisson2multinom</a></code>.</p></dd>
<dt>dat</dt>
<dd><p>A data frame passed as input to
<code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></code>, containing, at a minimum, columns
“sample”, “topic” and “prop”: the
“sample” column contains the positions of the samples (rows
of the L matrix) along the horizontal axis; the “topic”
column is a topic (a column of L); and the “prop” column is
the topic proportion for the respective sample.</p></dd>
<dt>ticks</dt>
<dd><p>The placement of the group labels along the horizontal
axis, and their names. For data that are not grouped, use
<code>ticks = NULL</code>.</p></dd>
<dt>font.size</dt>
<dd><p>Font size used in plot.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>ggplot</code> object.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The name “Structure plot” comes from its widespread
use in population genetics to visualize the results of the
Structure software (Rosenberg <em>et al</em>, 2002).</p>
<p>For most uses of the Structure plot in population genetics, there
is usually some grouping of the samples (e.g., assignment to
pre-defined populations) that guides arrangement of the samples
along the horizontal axis in the bar chart. In other applications,
such as analysis of gene expression data, a pre-defined grouping
may not always be available. Therefore, a “smart”
arrangement of the samples is, by default, generated automatically
by performing a 1-d embedding of the samples.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Dey, K. K., Hsiao, C. J. and Stephens, M. (2017). Visualizing the
structure of RNA-seq expression data using grade of membership
models. <em>PLoS Genetics</em> <b>13</b>, e1006599.</p>
<p>Rosenberg, N. A., Pritchard, J. K., Weber, J. L., Cann, H. M.,
Kidd, K. K., Zhivotovsky, L. A. and Feldman, M. W. (2002). Genetic
structure of human populations. <em>Science</em> <b>298</b>,
2381–2385.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pbmc_facs</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Get the multinomial topic model fitted to the</span></span>
<span class="r-in"><span class="co"># PBMC data.</span></span>
<span class="r-in"><span class="va">fit</span> <span class="op">&lt;-</span> <span class="va">pbmc_facs</span><span class="op">$</span><span class="va">fit</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Create a Structure plot without labels. The samples (rows of L) are</span></span>
<span class="r-in"><span class="co"># automatically arranged along the x-axis using t-SNE to highlight the</span></span>
<span class="r-in"><span class="co"># structure in the data.</span></span>
<span class="r-in"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">structure_plot</span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running tsne on 2000 x 6 matrix.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Read the 2000 x 6 data matrix successfully!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OpenMP is working. 1 threads.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using no_dims = 1, perplexity = 100.000000, and theta = 0.100000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Computing input similarities...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Building tree...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done in 0.61 seconds (sparsity = 0.184733)!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Learning embedding...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 50: error is 57.790679 (50 iterations in 0.30 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 100: error is 49.861306 (50 iterations in 0.29 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 150: error is 48.283663 (50 iterations in 0.30 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 200: error is 47.583935 (50 iterations in 0.27 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 250: error is 47.185906 (50 iterations in 0.28 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 300: error is 0.829310 (50 iterations in 0.28 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 350: error is 0.574113 (50 iterations in 0.28 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 400: error is 0.463630 (50 iterations in 0.28 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 450: error is 0.408564 (50 iterations in 0.28 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 500: error is 0.378602 (50 iterations in 0.28 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 550: error is 0.361187 (50 iterations in 0.27 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 600: error is 0.350349 (50 iterations in 0.28 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 650: error is 0.343237 (50 iterations in 0.28 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 700: error is 0.338447 (50 iterations in 0.28 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 750: error is 0.335129 (50 iterations in 0.28 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 800: error is 0.332753 (50 iterations in 0.28 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 850: error is 0.330927 (50 iterations in 0.29 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 900: error is 0.329686 (50 iterations in 0.28 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 950: error is 0.328633 (50 iterations in 0.28 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 1000: error is 0.327787 (50 iterations in 0.29 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting performed in 5.64 seconds.</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Create a Structure plot with the FACS cell-type labels. Within each</span></span>
<span class="r-in"><span class="co"># group (cell-type), the cells (rows of L) are automatically arranged</span></span>
<span class="r-in"><span class="co"># using t-SNE.</span></span>
<span class="r-in"><span class="va">subpop</span> <span class="op">&lt;-</span> <span class="va">pbmc_facs</span><span class="op">$</span><span class="va">samples</span><span class="op">$</span><span class="va">subpop</span></span>
<span class="r-in"><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">structure_plot</span><span class="op">(</span><span class="va">fit</span>,grouping <span class="op">=</span> <span class="va">subpop</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running tsne on 428 x 6 matrix.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Read the 428 x 6 data matrix successfully!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OpenMP is working. 1 threads.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using no_dims = 1, perplexity = 100.000000, and theta = 0.100000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Computing input similarities...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Building tree...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done in 0.12 seconds (sparsity = 0.857553)!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Learning embedding...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 50: error is 46.068049 (50 iterations in 0.05 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 100: error is 46.066009 (50 iterations in 0.05 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 150: error is 45.929280 (50 iterations in 0.05 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 200: error is 45.689352 (50 iterations in 0.05 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 250: error is 45.680291 (50 iterations in 0.05 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 300: error is 0.417504 (50 iterations in 0.05 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 350: error is 0.415709 (50 iterations in 0.05 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 400: error is 0.415706 (50 iterations in 0.05 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 450: error is 0.415706 (50 iterations in 0.05 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 500: error is 0.415706 (50 iterations in 0.05 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 550: error is 0.415706 (50 iterations in 0.05 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 600: error is 0.415706 (50 iterations in 0.05 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 650: error is 0.415706 (50 iterations in 0.05 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 700: error is 0.415706 (50 iterations in 0.05 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 750: error is 0.415706 (50 iterations in 0.05 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 800: error is 0.415705 (50 iterations in 0.05 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 850: error is 0.415706 (50 iterations in 0.05 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 900: error is 0.415706 (50 iterations in 0.05 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 950: error is 0.415706 (50 iterations in 0.05 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 1000: error is 0.415706 (50 iterations in 0.05 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting performed in 1.01 seconds.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running tsne on 89 x 6 matrix.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Read the 89 x 6 data matrix successfully!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OpenMP is working. 1 threads.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using no_dims = 1, perplexity = 28.000000, and theta = 0.100000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Computing input similarities...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Building tree...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done in 0.00 seconds (sparsity = 0.984724)!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Learning embedding...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 50: error is 50.796039 (50 iterations in 0.01 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 100: error is 49.294609 (50 iterations in 0.01 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 150: error is 50.029133 (50 iterations in 0.01 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 200: error is 52.434520 (50 iterations in 0.01 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 250: error is 51.042966 (50 iterations in 0.01 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 300: error is 2.204181 (50 iterations in 0.01 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 350: error is 0.298109 (50 iterations in 0.01 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 400: error is 0.276139 (50 iterations in 0.01 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 450: error is 0.276117 (50 iterations in 0.01 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 500: error is 0.276118 (50 iterations in 0.01 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 550: error is 0.276118 (50 iterations in 0.01 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 600: error is 0.276118 (50 iterations in 0.01 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 650: error is 0.276118 (50 iterations in 0.01 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 700: error is 0.276118 (50 iterations in 0.01 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 750: error is 0.276117 (50 iterations in 0.01 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 800: error is 0.276118 (50 iterations in 0.01 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 850: error is 0.276118 (50 iterations in 0.01 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 900: error is 0.276118 (50 iterations in 0.01 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 950: error is 0.276117 (50 iterations in 0.01 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 1000: error is 0.276118 (50 iterations in 0.01 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting performed in 0.13 seconds.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running tsne on 337 x 6 matrix.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Read the 337 x 6 data matrix successfully!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OpenMP is working. 1 threads.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using no_dims = 1, perplexity = 100.000000, and theta = 0.100000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Computing input similarities...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Building tree...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done in 0.09 seconds (sparsity = 0.978101)!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Learning embedding...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 50: error is 42.894862 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 100: error is 42.891002 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 150: error is 42.818965 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 200: error is 42.612440 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 250: error is 42.515986 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 300: error is 0.258088 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 350: error is 0.257636 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 400: error is 0.257632 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 450: error is 0.257633 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 500: error is 0.257632 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 550: error is 0.257634 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 600: error is 0.257634 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 650: error is 0.257633 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 700: error is 0.257632 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 750: error is 0.257633 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 800: error is 0.257634 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 850: error is 0.257632 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 900: error is 0.257633 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 950: error is 0.257634 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 1000: error is 0.257633 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting performed in 0.71 seconds.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running tsne on 356 x 6 matrix.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Read the 356 x 6 data matrix successfully!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OpenMP is working. 1 threads.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using no_dims = 1, perplexity = 100.000000, and theta = 0.100000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Computing input similarities...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Building tree...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done in 0.10 seconds (sparsity = 0.954141)!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Learning embedding...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 50: error is 44.012322 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 100: error is 44.008936 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 150: error is 43.983331 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 200: error is 43.886940 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 250: error is 43.815308 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 300: error is 0.333246 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 350: error is 0.332928 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 400: error is 0.332928 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 450: error is 0.332928 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 500: error is 0.332928 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 550: error is 0.332928 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 600: error is 0.332928 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 650: error is 0.332928 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 700: error is 0.332928 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 750: error is 0.332928 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 800: error is 0.332928 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 850: error is 0.332928 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 900: error is 0.332928 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 950: error is 0.332928 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 1000: error is 0.332928 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting performed in 0.73 seconds.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running tsne on 790 x 6 matrix.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Read the 790 x 6 data matrix successfully!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OpenMP is working. 1 threads.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using no_dims = 1, perplexity = 100.000000, and theta = 0.100000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Computing input similarities...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Building tree...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done in 0.23 seconds (sparsity = 0.497827)!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Learning embedding...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 50: error is 50.311476 (50 iterations in 0.10 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 100: error is 48.367697 (50 iterations in 0.09 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 150: error is 48.366598 (50 iterations in 0.09 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 200: error is 48.366598 (50 iterations in 0.09 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 250: error is 48.366594 (50 iterations in 0.10 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 300: error is 0.459507 (50 iterations in 0.10 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 350: error is 0.414759 (50 iterations in 0.10 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 400: error is 0.409702 (50 iterations in 0.09 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 450: error is 0.409160 (50 iterations in 0.10 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 500: error is 0.409129 (50 iterations in 0.10 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 550: error is 0.409130 (50 iterations in 0.10 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 600: error is 0.409124 (50 iterations in 0.10 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 650: error is 0.409128 (50 iterations in 0.10 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 700: error is 0.409128 (50 iterations in 0.10 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 750: error is 0.409124 (50 iterations in 0.10 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 800: error is 0.409128 (50 iterations in 0.10 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 850: error is 0.409128 (50 iterations in 0.10 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 900: error is 0.409127 (50 iterations in 0.10 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 950: error is 0.409128 (50 iterations in 0.10 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 1000: error is 0.409124 (50 iterations in 0.10 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting performed in 1.93 seconds.</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Next, we apply some customizations to improve the plot: (1) use the</span></span>
<span class="r-in"><span class="co"># "topics" argument to specify the order in which the topic</span></span>
<span class="r-in"><span class="co"># proportions are stacked on top of each other; (2) use the "gap"</span></span>
<span class="r-in"><span class="co"># argrument to increase the whitespace between the groups; (3) use "n"</span></span>
<span class="r-in"><span class="co"># to decrease the number of rows of L included in the Structure plot;</span></span>
<span class="r-in"><span class="co"># and (4) use "colors" to change the colors used to draw the topic</span></span>
<span class="r-in"><span class="co"># proportions.</span></span>
<span class="r-in"><span class="va">topic_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"skyblue"</span>,<span class="st">"forestgreen"</span>,<span class="st">"darkmagenta"</span>,</span>
<span class="r-in">                  <span class="st">"dodgerblue"</span>,<span class="st">"gold"</span>,<span class="st">"darkorange"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">structure_plot</span><span class="op">(</span><span class="va">fit</span>,grouping <span class="op">=</span> <span class="va">pbmc_facs</span><span class="op">$</span><span class="va">samples</span><span class="op">$</span><span class="va">subpop</span>,gap <span class="op">=</span> <span class="fl">20</span>,</span>
<span class="r-in">                     n <span class="op">=</span> <span class="fl">1500</span>,topics <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span>,colors <span class="op">=</span> <span class="va">topic_colors</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running tsne on 295 x 6 matrix.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Read the 295 x 6 data matrix successfully!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OpenMP is working. 1 threads.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using no_dims = 1, perplexity = 97.000000, and theta = 0.100000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Computing input similarities...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Building tree...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done in 0.08 seconds (sparsity = 0.996403)!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Learning embedding...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 50: error is 41.858935 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 100: error is 41.858669 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 150: error is 41.861621 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 200: error is 41.859881 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 250: error is 41.860017 (50 iterations in 0.04 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 300: error is 0.324563 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 350: error is 0.313767 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 400: error is 0.313313 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 450: error is 0.313482 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 500: error is 0.313482 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 550: error is 0.313481 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 600: error is 0.313482 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 650: error is 0.313482 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 700: error is 0.313142 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 750: error is 0.312468 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 800: error is 0.313480 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 850: error is 0.313480 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 900: error is 0.313480 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 950: error is 0.313143 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 1000: error is 0.313481 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting performed in 0.64 seconds.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running tsne on 72 x 6 matrix.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Read the 72 x 6 data matrix successfully!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OpenMP is working. 1 threads.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using no_dims = 1, perplexity = 22.000000, and theta = 0.100000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Computing input similarities...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Building tree...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done in 0.00 seconds (sparsity = 0.976466)!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Learning embedding...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 50: error is 52.440063 (50 iterations in 0.00 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 100: error is 52.118869 (50 iterations in 0.00 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 150: error is 52.374758 (50 iterations in 0.00 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 200: error is 49.909709 (50 iterations in 0.00 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 250: error is 52.440649 (50 iterations in 0.00 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 300: error is 1.508999 (50 iterations in 0.01 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 350: error is 0.857924 (50 iterations in 0.00 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 400: error is 0.770116 (50 iterations in 0.00 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 450: error is 0.769413 (50 iterations in 0.00 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 500: error is 0.769339 (50 iterations in 0.00 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 550: error is 0.769330 (50 iterations in 0.00 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 600: error is 0.769330 (50 iterations in 0.00 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 650: error is 0.769330 (50 iterations in 0.00 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 700: error is 0.769332 (50 iterations in 0.00 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 750: error is 0.769333 (50 iterations in 0.00 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 800: error is 0.769341 (50 iterations in 0.00 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 850: error is 0.769332 (50 iterations in 0.00 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 900: error is 0.769331 (50 iterations in 0.00 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 950: error is 0.769333 (50 iterations in 0.00 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 1000: error is 0.769333 (50 iterations in 0.00 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting performed in 0.09 seconds.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running tsne on 287 x 6 matrix.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Read the 287 x 6 data matrix successfully!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OpenMP is working. 1 threads.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using no_dims = 1, perplexity = 94.000000, and theta = 0.100000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Computing input similarities...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Building tree...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done in 0.07 seconds (sparsity = 0.996151)!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Learning embedding...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 50: error is 41.760880 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 100: error is 41.751621 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 150: error is 41.754161 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 200: error is 41.751217 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 250: error is 41.754137 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 300: error is 0.196220 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 350: error is 0.194830 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 400: error is 0.194814 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 450: error is 0.194815 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 500: error is 0.194814 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 550: error is 0.194814 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 600: error is 0.194814 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 650: error is 0.194814 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 700: error is 0.194814 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 750: error is 0.194814 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 800: error is 0.194814 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 850: error is 0.194814 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 900: error is 0.194814 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 950: error is 0.194814 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 1000: error is 0.194814 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting performed in 0.58 seconds.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running tsne on 264 x 6 matrix.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Read the 264 x 6 data matrix successfully!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OpenMP is working. 1 threads.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using no_dims = 1, perplexity = 86.000000, and theta = 0.100000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Computing input similarities...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Building tree...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done in 0.06 seconds (sparsity = 0.995552)!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Learning embedding...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 50: error is 42.239220 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 100: error is 42.234884 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 150: error is 42.234041 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 200: error is 42.225193 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 250: error is 42.235166 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 300: error is 0.288490 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 350: error is 0.286906 (50 iterations in 0.02 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 400: error is 0.286902 (50 iterations in 0.02 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 450: error is 0.286902 (50 iterations in 0.02 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 500: error is 0.286902 (50 iterations in 0.02 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 550: error is 0.286902 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 600: error is 0.286902 (50 iterations in 0.02 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 650: error is 0.286902 (50 iterations in 0.02 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 700: error is 0.286902 (50 iterations in 0.02 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 750: error is 0.286902 (50 iterations in 0.02 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 800: error is 0.286902 (50 iterations in 0.02 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 850: error is 0.286902 (50 iterations in 0.02 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 900: error is 0.286902 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 950: error is 0.286902 (50 iterations in 0.02 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 1000: error is 0.286902 (50 iterations in 0.03 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting performed in 0.51 seconds.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running tsne on 582 x 6 matrix.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Read the 582 x 6 data matrix successfully!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OpenMP is working. 1 threads.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using no_dims = 1, perplexity = 100.000000, and theta = 0.100000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Computing input similarities...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Building tree...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done in 0.16 seconds (sparsity = 0.671066)!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Learning embedding...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 50: error is 48.635769 (50 iterations in 0.08 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 100: error is 46.139671 (50 iterations in 0.07 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 150: error is 46.137047 (50 iterations in 0.07 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 200: error is 46.137043 (50 iterations in 0.07 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 250: error is 46.137046 (50 iterations in 0.07 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 300: error is 0.269337 (50 iterations in 0.07 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 350: error is 0.256593 (50 iterations in 0.07 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 400: error is 0.256364 (50 iterations in 0.07 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 450: error is 0.256364 (50 iterations in 0.07 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 500: error is 0.256364 (50 iterations in 0.07 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 550: error is 0.256365 (50 iterations in 0.07 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 600: error is 0.256365 (50 iterations in 0.07 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 650: error is 0.256363 (50 iterations in 0.07 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 700: error is 0.256364 (50 iterations in 0.07 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 750: error is 0.256364 (50 iterations in 0.07 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 800: error is 0.256364 (50 iterations in 0.07 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 850: error is 0.256364 (50 iterations in 0.07 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 900: error is 0.256364 (50 iterations in 0.07 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 950: error is 0.256364 (50 iterations in 0.07 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 1000: error is 0.256364 (50 iterations in 0.07 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting performed in 1.45 seconds.</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># In this example, we use UMAP instead of t-SNE to arrange the</span></span>
<span class="r-in"><span class="co"># cells in the Structure plot. Note that this can be accomplished in</span></span>
<span class="r-in"><span class="co"># a different way by overriding the default setting of</span></span>
<span class="r-in"><span class="co"># "embed_method".</span></span>
<span class="r-in"><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/drop.html" class="external-link">drop</a></span><span class="op">(</span><span class="fu"><a href="embeddings_from_topics.html">umap_from_topics</a></span><span class="op">(</span><span class="va">fit</span>,dims <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:49:35 UMAP embedding parameters a = 1.896 b = 0.8006</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:49:35 Read 3774 rows and found 6 numeric columns</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:49:35 Using FNN for neighbor search, n_neighbors = 30</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:49:35 Commencing smooth kNN distance calibration using 2 threads</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:49:35 111 smooth knn distance failures</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:49:36 Initializing from normalized Laplacian + noise</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:49:37 Commencing optimization for 500 epochs, with 138012 positive edges</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:49:41 Optimization finished</span>
<span class="r-in"><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu">structure_plot</span><span class="op">(</span><span class="va">fit</span>,loadings_order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,grouping <span class="op">=</span> <span class="va">subpop</span>,</span>
<span class="r-in">                     gap <span class="op">=</span> <span class="fl">40</span>,colors <span class="op">=</span> <span class="va">topic_colors</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># We can also use PCA to arrange the cells.</span></span>
<span class="r-in"><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/drop.html" class="external-link">drop</a></span><span class="op">(</span><span class="fu"><a href="embeddings_from_topics.html">pca_from_topics</a></span><span class="op">(</span><span class="va">fit</span>,dims <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu">structure_plot</span><span class="op">(</span><span class="va">fit</span>,loadings_order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,grouping <span class="op">=</span> <span class="va">subpop</span>,</span>
<span class="r-in">                     gap <span class="op">=</span> <span class="fl">40</span>,colors <span class="op">=</span> <span class="va">topic_colors</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># In this final example, we plot a random subset of 400 cells, and</span></span>
<span class="r-in"><span class="co"># arrange the cells randomly along the horizontal axis of the</span></span>
<span class="r-in"><span class="co"># Structure plot.</span></span>
<span class="r-in"><span class="va">p6</span> <span class="op">&lt;-</span> <span class="fu">structure_plot</span><span class="op">(</span><span class="va">fit</span>,loadings_order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">3744</span>,<span class="fl">400</span><span class="op">)</span>,gap <span class="op">=</span> <span class="fl">10</span>,</span>
<span class="r-in">                     grouping <span class="op">=</span> <span class="va">subpop</span>,colors <span class="op">=</span> <span class="va">topic_colors</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># }</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Peter Carbonetto, Kevin Luo, Kushal Dey, Matthew
Stephens.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

