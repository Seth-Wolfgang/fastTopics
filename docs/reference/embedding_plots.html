<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>PCA, t-SNE and UMAP Plots — embedding_plot_2d • fastTopics</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="PCA, t-SNE and UMAP Plots — embedding_plot_2d"><meta property="og:description" content="Visualize the structure of the Poisson NMF loadings or
  the multinomial topic model topic proportions by projection onto
  a 2-d surface. plot_hexbin_plot is most useful for
  visualizing the PCs of a data set with thousands of samples or
  more."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">fastTopics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6-147</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/stephenslab/fastTopics" class="external-link">Source</a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>PCA, t-SNE and UMAP Plots</h1>
    <small class="dont-index">Source: <a href="https://github.com/stephenslab/fastTopics/blob/HEAD/R/embedding_plots.R" class="external-link"><code>R/embedding_plots.R</code></a></small>
    <div class="hidden name"><code>embedding_plots.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Visualize the structure of the Poisson NMF loadings or
  the multinomial topic model topic proportions by projection onto
  a 2-d surface. <code>plot_hexbin_plot</code> is most useful for
  visualizing the PCs of a data set with thousands of samples or
  more.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">embedding_plot_2d</span><span class="op">(</span>
  <span class="va">fit</span>,
  <span class="va">Y</span>,
  fill <span class="op">=</span> <span class="st">"loading"</span>,
  <span class="va">k</span>,
  <span class="va">fill.label</span>,
  ggplot_call <span class="op">=</span> <span class="va">embedding_plot_2d_ggplot_call</span>,
  plot_grid_call <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">plots</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">plot_grid</span>, <span class="va">plots</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu">embedding_plot_2d_ggplot_call</span><span class="op">(</span>
  <span class="va">Y</span>,
  <span class="va">fill</span>,
  fill.type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loading"</span>, <span class="st">"numeric"</span>, <span class="st">"factor"</span>, <span class="st">"none"</span><span class="op">)</span>,
  <span class="va">fill.label</span>,
  font.size <span class="op">=</span> <span class="fl">9</span>
<span class="op">)</span>

<span class="fu">pca_plot</span><span class="op">(</span>
  <span class="va">fit</span>,
  <span class="va">Y</span>,
  pcs <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,
  n <span class="op">=</span> <span class="fl">10000</span>,
  fill <span class="op">=</span> <span class="st">"loading"</span>,
  <span class="va">k</span>,
  <span class="va">fill.label</span>,
  ggplot_call <span class="op">=</span> <span class="va">embedding_plot_2d_ggplot_call</span>,
  plot_grid_call <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">plots</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">plot_grid</span>, <span class="va">plots</span><span class="op">)</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="fu">tsne_plot</span><span class="op">(</span>
  <span class="va">fit</span>,
  <span class="va">Y</span>,
  n <span class="op">=</span> <span class="fl">2000</span>,
  fill <span class="op">=</span> <span class="st">"loading"</span>,
  <span class="va">k</span>,
  <span class="va">fill.label</span>,
  ggplot_call <span class="op">=</span> <span class="va">embedding_plot_2d_ggplot_call</span>,
  plot_grid_call <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">plots</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">plot_grid</span>, <span class="va">plots</span><span class="op">)</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="fu">umap_plot</span><span class="op">(</span>
  <span class="va">fit</span>,
  <span class="va">Y</span>,
  n <span class="op">=</span> <span class="fl">2000</span>,
  fill <span class="op">=</span> <span class="st">"loading"</span>,
  <span class="va">k</span>,
  <span class="va">fill.label</span>,
  ggplot_call <span class="op">=</span> <span class="va">embedding_plot_2d_ggplot_call</span>,
  plot_grid_call <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">plots</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">plot_grid</span>, <span class="va">plots</span><span class="op">)</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="fu">pca_hexbin_plot</span><span class="op">(</span>
  <span class="va">fit</span>,
  <span class="va">Y</span>,
  pcs <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,
  bins <span class="op">=</span> <span class="fl">40</span>,
  breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">100</span>, <span class="fl">1000</span>, <span class="cn">Inf</span><span class="op">)</span>,
  ggplot_call <span class="op">=</span> <span class="va">pca_hexbin_plot_ggplot_call</span>,
  <span class="va">...</span>
<span class="op">)</span>

<span class="fu">pca_hexbin_plot_ggplot_call</span><span class="op">(</span><span class="va">Y</span>, <span class="va">bins</span>, <span class="va">breaks</span>, font.size <span class="op">=</span> <span class="fl">9</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>fit</dt>
<dd><p>An object of class “poisson_nmf_fit” or
“multinom_topic_model_fit”.</p></dd>
<dt>Y</dt>
<dd><p>The n x 2 matrix containing the 2-d embedding, where n is
the number of rows in <code>fit$L</code>. If not provided, the embedding
will be computed automatically.</p></dd>
<dt>fill</dt>
<dd><p>The quantity to map onto the fill colour of the points
in the PCA plot. Set <code>fill = "loading"</code> to vary the fill
colour according to the loadings (or topic proportions) of the
select topiced or topics. Alternatively, <code>fill</code> may be set to a
data vector with one entry per row of <code>fit$L</code>, in which case
the data are mapped to the fill colour of the points. When
<code>fill = "none"</code>, the fill colour is not varied.</p></dd>
<dt>k</dt>
<dd><p>The dimensions or topics selected by number or name. When
<code>fill = "loading"</code>, one plot is created per selected dimension
or topic; when <code>fill = "loading"</code> and <code>k</code> is not
specified, all dimensions or topics are plotted.</p></dd>
<dt>fill.label</dt>
<dd><p>The label used for the fill colour legend.</p></dd>
<dt>ggplot_call</dt>
<dd><p>The function used to create the plot. Replace
<code>embedding_plot_2d_ggplot_call</code> or <code>pca_hexbin_plot_ggplot_call</code>
with your own function to customize the appearance of the plot.</p></dd>
<dt>plot_grid_call</dt>
<dd><p>When <code>fill = "loading"</code> and multiple
topics (<code>k</code>) are selected, this is the function used to
arrange the plots into a grid using <code><a href="https://wilkelab.org/cowplot/reference/plot_grid.html" class="external-link">plot_grid</a></code>.
It should be a function accepting a single argument, <code>plots</code>,
a list of <code>ggplot</code> objects.</p></dd>
<dt>fill.type</dt>
<dd><p>The type of variable mapped to fill colour. The
fill colour is not varied when <code>fill.type = "none"</code>.</p></dd>
<dt>font.size</dt>
<dd><p>Font size used in plot.</p></dd>
<dt>pcs</dt>
<dd><p>The two principal components (PCs) to be plotted,
specified by name or number.</p></dd>
<dt>n</dt>
<dd><p>The maximum number of points to plot. If <code>n</code> is less
than the number of rows of <code>fit$L</code>, the rows are subsampled at
random. This argument is ignored if <code>Y</code> is provided.</p></dd>
<dt>...</dt>
<dd><p>Additional arguments passed to
<code><a href="embeddings_from_topics.html">pca_from_topics</a></code>, <code><a href="embeddings_from_topics.html">tsne_from_topics</a></code> or
<code><a href="embeddings_from_topics.html">umap_from_topics</a></code>. These additional arguments are only
used if <code>Y</code> is not provided.</p></dd>
<dt>bins</dt>
<dd><p>Number of bins used to create hexagonal 2-d
histogram. Passed as the “bins” argument to
<code><a href="https://ggplot2.tidyverse.org/reference/geom_hex.html" class="external-link">stat_bin_hex</a></code>.</p></dd>
<dt>breaks</dt>
<dd><p>To produce the hexagonal histogram, the counts are
subdivided into intervals based on <code>breaks</code>. Passed as the
“breaks” argument to <code><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></code>.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <code>ggplot</code> object.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This is a lightweight interface primarily intended to
expedite creation of plots for visualizing the loadings or topic
proportions; most of the heavy lifting is done by
‘ggplot2’. The 2-d embedding itself is computed by invoking
<code><a href="embeddings_from_topics.html">pca_from_topics</a></code>, <code><a href="embeddings_from_topics.html">tsne_from_topics</a></code> or
<code><a href="embeddings_from_topics.html">umap_from_topics</a></code>. For more control over the plot's
appearance, the plot can be customized by modifying the
<code>ggplot_call</code> and <code>plot_grid_call</code> arguments.</p>
<p>An effective 2-d visualization may also require some fine-tunning
of the settings, such as the t-SNE “perplexity”, or the
number of samples included in the plot. The PCA, UMAP, t-SNE
settings can be controlled by the additional arguments
(...). Alternatively, a 2-d embedding may be pre-computed, and
passed as argument <code>Y</code>.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="embeddings_from_topics.html">pca_from_topics</a></code>,
  <code><a href="embeddings_from_topics.html">tsne_from_topics</a></code>,
  <code><a href="embeddings_from_topics.html">umap_from_topics</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">pbmc_facs</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Get the Poisson NMF and multinomial topic models fitted to the</span></span>
<span class="r-in"><span class="co"># PBMC data.</span></span>
<span class="r-in"><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="multinom2poisson.html">multinom2poisson</a></span><span class="op">(</span><span class="va">pbmc_facs</span><span class="op">$</span><span class="va">fit</span><span class="op">)</span></span>
<span class="r-in"><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="va">pbmc_facs</span><span class="op">$</span><span class="va">fit</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Plot the first two PCs of the loadings matrix (for the</span></span>
<span class="r-in"><span class="co"># multinomial topic model, "fit2", the loadings are the topic</span></span>
<span class="r-in"><span class="co"># proportions).</span></span>
<span class="r-in"><span class="va">subpop</span> <span class="op">&lt;-</span> <span class="va">pbmc_facs</span><span class="op">$</span><span class="va">samples</span><span class="op">$</span><span class="va">subpop</span></span>
<span class="r-in"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">pca_plot</span><span class="op">(</span><span class="va">fit1</span>,k <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">pca_plot</span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">pca_plot</span><span class="op">(</span><span class="va">fit2</span>,fill <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu">pca_plot</span><span class="op">(</span><span class="va">fit2</span>,pcs <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">4</span>,fill <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu">pca_plot</span><span class="op">(</span><span class="va">fit2</span>,fill <span class="op">=</span> <span class="va">fit2</span><span class="op">$</span><span class="va">L</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"><span class="va">p6</span> <span class="op">&lt;-</span> <span class="fu">pca_plot</span><span class="op">(</span><span class="va">fit2</span>,fill <span class="op">=</span> <span class="va">subpop</span><span class="op">)</span></span>
<span class="r-in"><span class="va">p7</span> <span class="op">&lt;-</span> <span class="fu">pca_hexbin_plot</span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">p8</span> <span class="op">&lt;-</span> <span class="fu">pca_hexbin_plot</span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"><span class="co"># Plot the loadings using t-SNE.</span></span>
<span class="r-in"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">tsne_plot</span><span class="op">(</span><span class="va">fit1</span>,k <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Read the 2000 x 6 data matrix successfully!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OpenMP is working. 1 threads.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using no_dims = 2, perplexity = 100.000000, and theta = 0.100000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Computing input similarities...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Building tree...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done in 0.62 seconds (sparsity = 0.195510)!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Learning embedding...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 50: error is 56.566020 (50 iterations in 0.99 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 100: error is 49.588009 (50 iterations in 0.70 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 150: error is 48.780437 (50 iterations in 0.63 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 200: error is 48.481760 (50 iterations in 0.62 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 250: error is 48.321616 (50 iterations in 0.67 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 300: error is 0.500184 (50 iterations in 0.82 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 350: error is 0.355462 (50 iterations in 0.90 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 400: error is 0.304304 (50 iterations in 0.86 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 450: error is 0.280181 (50 iterations in 0.84 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 500: error is 0.266792 (50 iterations in 0.83 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 550: error is 0.258517 (50 iterations in 0.78 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 600: error is 0.252917 (50 iterations in 0.83 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 650: error is 0.248990 (50 iterations in 0.79 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 700: error is 0.246069 (50 iterations in 0.78 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 750: error is 0.243836 (50 iterations in 0.84 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 800: error is 0.242063 (50 iterations in 0.80 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 850: error is 0.240679 (50 iterations in 0.78 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 900: error is 0.239602 (50 iterations in 0.78 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 950: error is 0.238714 (50 iterations in 0.76 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 1000: error is 0.237994 (50 iterations in 0.74 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting performed in 15.75 seconds.</span>
<span class="r-in"><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">tsne_plot</span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Read the 2000 x 6 data matrix successfully!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OpenMP is working. 1 threads.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using no_dims = 2, perplexity = 100.000000, and theta = 0.100000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Computing input similarities...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Building tree...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done in 0.62 seconds (sparsity = 0.185092)!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Learning embedding...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 50: error is 55.169629 (50 iterations in 1.06 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 100: error is 48.296536 (50 iterations in 0.67 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 150: error is 47.208215 (50 iterations in 0.60 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 200: error is 46.768378 (50 iterations in 0.56 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 250: error is 46.529132 (50 iterations in 0.56 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 300: error is 0.481751 (50 iterations in 0.72 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 350: error is 0.333907 (50 iterations in 0.74 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 400: error is 0.276316 (50 iterations in 0.72 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 450: error is 0.247547 (50 iterations in 0.73 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 500: error is 0.231735 (50 iterations in 0.69 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 550: error is 0.222157 (50 iterations in 0.72 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 600: error is 0.215846 (50 iterations in 0.67 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 650: error is 0.211401 (50 iterations in 0.79 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 700: error is 0.208026 (50 iterations in 0.65 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 750: error is 0.205488 (50 iterations in 0.72 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 800: error is 0.203476 (50 iterations in 0.68 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 850: error is 0.201817 (50 iterations in 0.67 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 900: error is 0.200466 (50 iterations in 0.67 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 950: error is 0.199298 (50 iterations in 0.69 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 1000: error is 0.198349 (50 iterations in 0.65 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting performed in 13.94 seconds.</span>
<span class="r-in"><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">tsne_plot</span><span class="op">(</span><span class="va">fit2</span>,fill <span class="op">=</span> <span class="va">subpop</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Read the 2000 x 6 data matrix successfully!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OpenMP is working. 1 threads.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Using no_dims = 2, perplexity = 100.000000, and theta = 0.100000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Computing input similarities...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Building tree...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Done in 0.58 seconds (sparsity = 0.184268)!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Learning embedding...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 50: error is 54.034875 (50 iterations in 1.17 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 100: error is 47.811956 (50 iterations in 0.73 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 150: error is 47.003071 (50 iterations in 0.71 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 200: error is 46.677254 (50 iterations in 0.67 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 250: error is 46.489028 (50 iterations in 0.67 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 300: error is 0.463680 (50 iterations in 0.72 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 350: error is 0.321646 (50 iterations in 0.77 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 400: error is 0.268448 (50 iterations in 0.82 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 450: error is 0.242447 (50 iterations in 0.78 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 500: error is 0.227653 (50 iterations in 0.77 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 550: error is 0.218327 (50 iterations in 0.74 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 600: error is 0.212016 (50 iterations in 0.78 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 650: error is 0.207504 (50 iterations in 0.74 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 700: error is 0.204139 (50 iterations in 0.75 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 750: error is 0.201572 (50 iterations in 0.83 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 800: error is 0.199485 (50 iterations in 0.78 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 850: error is 0.197809 (50 iterations in 0.78 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 900: error is 0.196472 (50 iterations in 0.79 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 950: error is 0.195349 (50 iterations in 0.78 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iteration 1000: error is 0.194371 (50 iterations in 0.78 seconds)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitting performed in 15.54 seconds.</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Plot the loadings using UMAP.</span></span>
<span class="r-in"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu">umap_plot</span><span class="op">(</span><span class="va">fit1</span>,k <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:14 UMAP embedding parameters a = 1.896 b = 0.8006</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:14 Read 2000 rows and found 6 numeric columns</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:14 Using FNN for neighbor search, n_neighbors = 30</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:14 Commencing smooth kNN distance calibration using 2 threads</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:14 Initializing from normalized Laplacian + noise</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:14 Commencing optimization for 500 epochs, with 74134 positive edges</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:17 Optimization finished</span>
<span class="r-in"><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu">umap_plot</span><span class="op">(</span><span class="va">fit2</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:17 UMAP embedding parameters a = 1.896 b = 0.8006</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:17 Read 2000 rows and found 6 numeric columns</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:17 Using FNN for neighbor search, n_neighbors = 30</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:17 Commencing smooth kNN distance calibration using 2 threads</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:17 64 smooth knn distance failures</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:17 Found 3 connected components, </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> falling back to 'spca' initialization with init_sdev = 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:17 Initializing from PCA</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:17 PCA: 2 components explained 65.66% variance</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:17 Commencing optimization for 500 epochs, with 72866 positive edges</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:20 Optimization finished</span>
<span class="r-in"><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu">umap_plot</span><span class="op">(</span><span class="va">fit2</span>,fill <span class="op">=</span> <span class="va">subpop</span><span class="op">)</span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:20 UMAP embedding parameters a = 1.896 b = 0.8006</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:20 Read 2000 rows and found 6 numeric columns</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:20 Using FNN for neighbor search, n_neighbors = 30</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:20 Commencing smooth kNN distance calibration using 2 threads</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:20 66 smooth knn distance failures</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:21 Found 2 connected components, </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> falling back to 'spca' initialization with init_sdev = 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:21 Initializing from PCA</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:21 PCA: 2 components explained 66.13% variance</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:21 Commencing optimization for 500 epochs, with 73072 positive edges</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 15:47:23 Optimization finished</span>
<span class="r-in"><span class="co"># }</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Peter Carbonetto, Kevin Luo, Kushal Dey, Matthew
Stephens.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

